# 摘要
扩展高斯模型的光照项，从而实现对任意材质的重光照

# 方法
## 高斯光照项
在3DGS渲染中，需要将高斯球投影到相机平面上，这需要对高斯保存的不透明度和视角方向的光照进行求和
![](论文/3DGS/pics/7.png)
高斯中的光照项$Li(\omega_o)$使用球谐函数编码了高斯球各方向的光照(颜色)信息，并且只和视线方向有关，这就导致了其不能直接用于重光照。
本文扩展了这一光照项，将其扩展为直接光照项和间接光照项。
$$
L(\omega_o)=L_{dir}(\omega_o)+L_{ind}
$$
直接光照项和视角相关而间接光照项与视角无关。
对于直接光照项，引入一个算子表示光线从光源到高斯球的衰减过程：
![](论文/3DGS/pics/8.png)
对于散射函数$f$，将其拆分为方向无关项和方向有关项，上述方程变为：
![](论文/3DGS/pics/9.png)
而对于间接光照，可直接将其写为：
![](论文/3DGS/pics/10.png)
## 球谐函数压缩
目前对于每个高斯球而言，渲染方程中的球面函数有$s(\cdot,\cdot),\mathcal{T}_{dir}(\cdot),\mathcal{T}_{ind}(\cdot)$
对于球面函数而言，使用单球谐函数可以表示，而对于$s$，则采用双向球谐函数进行压缩，即：
![](论文/3DGS/pics/11.png)
其中$y$是球谐基函数。
可以证明的是，利用对称性，可将$n^2$个球谐函数基降低到$\frac{n(n+1)}{2}$个
如果光源(或视角)不变，上述可以退化到使用单球谐函数的情况，即：
![](论文/3DGS/pics/12.png)
## 渲染
有了上述估计，可以使用以下方程计算高斯的光照项：
![](论文/3DGS/pics/13.png)
上述方程是考虑了方向光。如果采用点光源，则只需在上述式子中加入平方衰减。如果采用环境光，则需要根据立体角采样环境贴图作为新的$L_e$。
## 训练
对于模型拟合，要考虑两个情况，一个是渲染图像的真实度，一个是对光源拆分的物理可信度(能量守恒)，因此Loss分为两个部分：
$$
\mathcal{L}=\mathcal{L}_{rec}+\mathcal{L}_{reg}
$$
对于重建损失，与高斯喷溅使用同一个损失函数：
$$
\mathcal{L}_{rec}=\mathcal{L}_1+\lambda_{D-SSIM}\mathcal{L}_{D-SSIM}
$$
为了保证拆分的散射项和传播项物理真实，物理可信度方面的损失函数如下:
$$
\mathcal{L}_{reg}=\lambda_s\mathcal{L}_{s}+\lambda_+\mathcal{L}_+
$$
首先考虑的是散射项的能量守恒问题，也就是其积分为1，损失如下：
![](论文/3DGS/pics/14.png)
其次是传播项和散射项的非负性，将其负数部分平方作为损失：
![](论文/3DGS/pics/15.png)
# 实验
## 对比实验
主要对比了R3DGS和GaussianShader两个方法，定性的来说，本文方法要优于其他的两个方法

## 消融实验
+ 去掉了归一化常数，发现渲染结果更亮了
+ 将散射函数的三通道改为1通道，发现金属边缘无法散射处彩虹光泽

## 性能
可以达到实时
![](论文/3DGS/pics/16.png)
# 局限
+ 球谐函数较为低频，无法表达高频散射等光照信息
+ 