# 阴影贴图
## 核心思想
使用两个Pass渲染场景，第一个Pass从光源的角度渲染，只保留每个点最近的深度。第二个从摄像机视角出发，根据第一次渲染的深度结果判断每个渲染点是否能被光源看到，从而生成阴影。

## 问题
### 自遮挡
当光源观察一个平面，观察角度与平面的角度过大时，由于阴影贴图每个像素覆盖的面积过大（分辨率有限），导致这样的平面上会出现自遮挡问题。
观察角度与平面夹角越大越容易出现这个问题（朝阳和夕阳）。

#### 解决方案1：Detached Shadow
在判断shadowmap深度的时候加大容错空间（bias），此容错区间可以由光源观察角度的变化动态调整

引入bias的问题：有可能造成一部分的阴影得不到渲染

#### 解决方案2：Second-depth shadow mapping
阴影贴图不仅记录离光源的最小深度，还记录次小深度，在进行相机渲染的时候利用最小和次小深度的平均值来进行计算

原理：在一个任何物体都有体积的场景中，最小和次小深度的中间值总在物体内部，因此总能得到遮挡

问题：
+ 对场景物体要求严格
+ 实现较为复杂（保存最小和次小值），运行速度慢（复杂度不变，常数大）

### 锯齿
由于shadowmap分辨率限制，shadowmap会产生阴影的锯齿