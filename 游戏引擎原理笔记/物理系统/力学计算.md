# 力学计算

## Euler方法
离散化时间，将时间切成一片一片

### 显式Euler积分
将整个事件依照时间切成小片，每个时刻根据前一时刻的速度与位移计算出当前的速度与位移
$$
\begin{align}
\vec{v}(t_1)=\vec{v}(t_0)+M^{-1}\vec{F}(t_0)\Delta t\\
\vec{x}(t_1)=\vec{x}(t_0)+\vec{v}(t_0)\Delta t \\
M:质量
\end{align}
$$
问题：由于每一时刻($t_1$)的状态都根据前一时刻($t_0$)的状态计算而来，会导致能量不守恒的问题（与Tick的时间步长有关，步长越小模拟越精确），而且能量容易无上界爆炸

### 隐式Euler积分
通过下一时刻的力与速度反向计算出这一时刻的位移与时间
$$
\begin{align}
\vec{v}(t_1)=\vec{v}(t_0)+M^{-1}\vec{F}(t_1)\Delta t\\
\vec{x}(t_1)=\vec{x}(t_0)+\vec{v}(t_1)\Delta t \\
M:质量
\end{align}
$$
问题：能量会衰减，但实际应用中可以接受，因为能量是由上界的

### 半隐式Euler积分(最为常用)
结合上述两种方法得到的便于计算的版本
$$
\begin{align}
\vec{v}(t_1)=\vec{v}(t_0)+M^{-1}\vec{F}(t_0)\Delta t\\
\vec{x}(t_1)=\vec{x}(t_0)+\vec{v}(t_1)\Delta t \\
M:质量
\end{align}
$$
默认力不随位移、速度等改变，先通过当前的力计算未来的速度，在使用未来的速度计算未来的位移，收敛极为迅速。

问题：不适用于简谐运动等，会发生相位偏差

## Runge-Kutta方法族
一系列数值计算方法，用于解微分方程
其中较为常用的方法为RK4，其中误差为4阶

[[布料模拟#Verlet积分]]